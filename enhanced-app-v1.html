<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>„Ç∞„É´„ÉÜ„É≥„Éï„É™„Éº„Éû„ÉÉ„Éó - Êã°ÂºµÁâàv1</title>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Hiragino Sans', 'Yu Gothic UI', sans-serif;
            background: #f5f5f5;
        }
        
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .login-form {
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            width: 400px;
            text-align: center;
        }
        
        .app-title {
            color: #ff6b9d;
            font-size: 2rem;
            margin-bottom: 30px;
        }
        
        .form-group {
            margin: 20px 0;
            text-align: left;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #333;
        }
        
        input {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
        }
        
        .login-btn {
            background: linear-gradient(45deg, #ff6b9d, #4ecdc4);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 16px;
            width: 100%;
            margin: 20px 0;
        }
        
        .login-btn:hover {
            opacity: 0.9;
        }
        
        .error {
            color: #dc3545;
            margin: 10px 0;
        }
        
        .app-container {
            display: none;
            height: 100vh;
        }
        
        .header {
            background: #ff6b9d;
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .content {
            display: flex;
            height: calc(100vh - 60px);
        }
        
        .sidebar {
            width: 380px;
            background: white;
            border-right: 1px solid #ddd;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
        }
        
        .search-section {
            padding: 20px;
            border-bottom: 1px solid #eee;
            background: #f8f9fa;
        }
        
        .search-input {
            width: 100%;
            padding: 12px 15px 12px 40px;
            border: 1px solid #ddd;
            border-radius: 25px;
            font-size: 14px;
            margin-bottom: 15px;
            background: white;
        }
        
        .search-icon {
            position: absolute;
            left: 35px;
            top: 32px;
            color: #999;
        }
        
        .search-input-container {
            position: relative;
        }
        
        .category-filters {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        
        .category-chip {
            padding: 6px 12px;
            border-radius: 15px;
            border: 1px solid #ddd;
            background: white;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.3s;
        }
        
        .category-chip:hover {
            background: #f0f0f0;
        }
        
        .category-chip.active {
            background: #ff6b9d;
            color: white;
            border-color: #ff6b9d;
        }
        
        .stores-header {
            padding: 15px 20px;
            border-bottom: 1px solid #eee;
            background: white;
        }
        
        .stores-count {
            font-weight: bold;
            color: #333;
        }
        
        .clear-filters {
            background: none;
            border: none;
            color: #ff6b9d;
            cursor: pointer;
            font-size: 13px;
            margin-left: 10px;
        }
        
        .map-container {
            flex: 1;
        }
        
        #map {
            height: 100%;
            width: 100%;
        }
        
        .store-list {
            flex: 1;
            overflow-y: auto;
        }
        
        .store-card {
            padding: 15px 20px;
            border-bottom: 1px solid #eee;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .store-card:hover {
            background: #f8f9fa;
        }
        
        .store-card.selected {
            background: #e3f2fd;
            border-left: 4px solid #ff6b9d;
        }
        
        .store-name {
            font-weight: bold;
            margin-bottom: 5px;
            color: #333;
        }
        
        .store-category {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 12px;
            margin-bottom: 5px;
        }
        
        .store-address {
            color: #666;
            font-size: 13px;
            line-height: 1.4;
        }
        
        .category-cafe { background: #8B4513; color: white; }
        .category-japanese { background: #FF6B6B; color: white; }
        .category-western { background: #4ECDC4; color: white; }
        .category-bakery { background: #FFB347; color: white; }
        .category-sweets { background: #FF69B4; color: white; }
        .category-shop { background: #32CD32; color: white; }
        
        .no-results {
            padding: 40px 20px;
            text-align: center;
            color: #666;
        }
        
        .logout-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .logout-btn:hover {
            background: rgba(255,255,255,0.3);
        }
        
        /* „Éû„Éº„Ç´„Éº„ÅÆ„Çπ„Çø„Ç§„É´ */
        .custom-marker {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        }
        
        /* „É¨„Çπ„Éù„É≥„Ç∑„ÉñÂØæÂøú */
        @media (max-width: 768px) {
            .content {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                height: 40vh;
                order: 2;
            }
            
            .map-container {
                height: 60vh;
                order: 1;
            }
        }
    </style>
</head>
<body>
    <!-- „É≠„Ç∞„Ç§„É≥ÁîªÈù¢ -->
    <div id="loginScreen" class="login-container">
        <div class="login-form">
            <h1 class="app-title">üç∞ „Ç∞„É´„ÉÜ„É≥„Éï„É™„Éº„Éû„ÉÉ„Éó</h1>
            <p style="margin-bottom: 30px; color: #666;">„Éì„É®„Ç∞„É™ÂÄ∂Ê•ΩÈÉ®</p>
            
            <div class="form-group">
                <label>„É°„Éº„É´„Ç¢„Éâ„É¨„Çπ</label>
                <input type="email" id="email" value="bettger1000@gmail.com">
            </div>
            
            <div class="form-group">
                <label>PIN (4Ê°Å)</label>
                <input type="text" id="pin" value="1234" maxlength="4">
            </div>
            
            <button class="login-btn" onclick="login()">üîì „É≠„Ç∞„Ç§„É≥</button>
            
            <div id="error" class="error" style="display: none;"></div>
        </div>
    </div>
    
    <!-- „Ç¢„Éó„É™ÁîªÈù¢ -->
    <div id="appScreen" class="app-container">
        <div class="header">
            <h1>üç∞ „Ç∞„É´„ÉÜ„É≥„Éï„É™„Éº„Éû„ÉÉ„Éó</h1>
            <button class="logout-btn" onclick="logout()">
                <i class="fas fa-sign-out-alt"></i>
                „É≠„Ç∞„Ç¢„Ç¶„Éà
            </button>
        </div>
        
        <div class="content">
            <div class="sidebar">
                <!-- Ê§úÁ¥¢„Éª„Éï„Ç£„É´„Çø„Éº„Çª„ÇØ„Ç∑„Éß„É≥ -->
                <div class="search-section">
                    <div class="search-input-container">
                        <i class="fas fa-search search-icon"></i>
                        <input type="text" id="searchInput" class="search-input" placeholder="Â∫óËàóÂêç„ÅßÊ§úÁ¥¢..." onkeyup="filterStores()">
                    </div>
                    
                    <div class="category-filters">
                        <div class="category-chip active" data-category="" onclick="selectCategory(this)">„Åô„Åπ„Å¶</div>
                        <div class="category-chip" data-category="„Ç´„Éï„Çß" onclick="selectCategory(this)">‚òï „Ç´„Éï„Çß</div>
                        <div class="category-chip" data-category="ÂíåÈ£ü" onclick="selectCategory(this)">üç± ÂíåÈ£ü</div>
                        <div class="category-chip" data-category="Ê¥ãÈ£ü" onclick="selectCategory(this)">üçù Ê¥ãÈ£ü</div>
                        <div class="category-chip" data-category="„Éë„É≥Â±ã" onclick="selectCategory(this)">ü•ñ „Éë„É≥Â±ã</div>
                        <div class="category-chip" data-category="„Çπ„Ç§„Éº„ÉÑ" onclick="selectCategory(this)">üç∞ „Çπ„Ç§„Éº„ÉÑ</div>
                        <div class="category-chip" data-category="Ë≤©Â£≤Â∫ó" onclick="selectCategory(this)">üõí Ë≤©Â£≤Â∫ó</div>
                    </div>
                </div>
                
                <!-- Â∫óËàóÊï∞Ë°®Á§∫ -->
                <div class="stores-header">
                    <span class="stores-count" id="storeCount">0‰ª∂„ÅÆÂ∫óËàó</span>
                    <button class="clear-filters" onclick="clearFilters()" id="clearBtn" style="display: none;">
                        <i class="fas fa-times"></i> „Éï„Ç£„É´„Çø„Éº„Çí„ÇØ„É™„Ç¢
                    </button>
                </div>
                
                <!-- Â∫óËàó„É™„Çπ„Éà -->
                <div class="store-list" id="storeList"></div>
            </div>
            
            <div class="map-container">
                <div id="map"></div>
            </div>
        </div>
    </div>
    
    <script>
        // SupabaseË®≠ÂÆö
        const SUPABASE_URL = 'https://hxrmsjfvgctoaxpbukvo.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imh4cm1zamZ2Z2N0b2F4cGJ1a3ZvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ5MTI3NTAsImV4cCI6MjA3MDQ4ODc1MH0.tM1vDVVhYhh7OHlA1BTj071BfsIzeBG_HatijjtxwLw';
        
        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY, {
            auth: {
                persistSession: false,
                autoRefreshToken: false
            }
        });
        
        let map;
        let markers = [];
        let currentUser = null;
        let selectedCategory = '';
        let searchText = '';
        
        // Êã°Âºµ„Åï„Çå„ÅüÂ∫óËàó„Éá„Éº„Çø
        const stores = [
            {
                id: 1,
                name: "„Åø„Å°„ÅÆ„ÇäÂºÅÂΩìÔºàGluten-Free Michinori BentoÔºâ",
                category: "ÂíåÈ£ü",
                address: "ÂêçÂè§Â±ãÂ∏ÇË•øÂå∫ÊµÑÂøÉÔºë‰∏ÅÁõÆÔºî‚àíÔºñ",
                latitude: 35.2040,
                longitude: 136.8922,
                description: "„Ç∞„É´„ÉÜ„É≥„Éï„É™„Éº„ÅÆÂíåÈ£üÂºÅÂΩìÂ∞ÇÈñÄÂ∫ó"
            },
            {
                id: 2,
                name: "Gluten Free Bakery „Åü„Çì„ÅΩ„ÅΩ",
                category: "„Éë„É≥Â±ã",
                address: "ÂêçÂè§Â±ãÂ∏Ç‰∏≠Âå∫Èå¶‰∏â‰∏ÅÁõÆÔºë‚àíÔºì",
                latitude: 35.1685,
                longitude: 136.9062,
                description: "Á±≥Á≤â„Çí‰Ωø„Å£„Åü„Ç∞„É´„ÉÜ„É≥„Éï„É™„Éº„Éë„É≥„ÅÆÂ∞ÇÈñÄÂ∫ó"
            },
            {
                id: 3,
                name: "Ëá™ÁÑ∂È£ü„Ç´„Éï„Çß „Åø„Å©„Çä",
                category: "„Ç´„Éï„Çß",
                address: "ÂêçÂè§Â±ãÂ∏ÇÊù±Âå∫Ê≥âÔºë‰∏ÅÁõÆÔºí‚àíÔºì",
                latitude: 35.1794,
                longitude: 136.9186,
                description: "„Ç™„Éº„Ç¨„Éã„ÉÉ„ÇØÈ£üÊùê‰ΩøÁî®„ÅÆ„Ç´„Éï„Çß"
            },
            {
                id: 4,
                name: "„Ç∞„É´„ÉÜ„É≥„Éï„É™„ÉºÊ¥ãÈ£ü„É¨„Çπ„Éà„É©„É≥ BEYOND",
                category: "Ê¥ãÈ£ü",
                address: "ÂêçÂè§Â±ãÂ∏Ç‰∏≠Âå∫Ê†ÑÔºì‰∏ÅÁõÆÔºëÔºï‚àíÔºìÔºì",
                latitude: 35.1676,
                longitude: 136.9040,
                description: "Êú¨Ê†ºÁöÑ„Å™„Ç∞„É´„ÉÜ„É≥„Éï„É™„ÉºÊ¥ãÈ£ü"
            },
            {
                id: 5,
                name: "„Çπ„Ç§„Éº„ÉÑ„Éë„É©„ÉÄ„Ç§„Çπ „Çª„É™„Ç¢„ÉÉ„ÇØ",
                category: "„Çπ„Ç§„Éº„ÉÑ",
                address: "ÂêçÂè§Â±ãÂ∏ÇÂçÉÁ®ÆÂå∫‰ªäÊ±†Ôºë‰∏ÅÁõÆÔºñ‚àíÔºí",
                latitude: 35.1583,
                longitude: 136.9281,
                description: "„Ç∞„É´„ÉÜ„É≥„Éï„É™„Éº„Çπ„Ç§„Éº„ÉÑÂ∞ÇÈñÄÂ∫ó"
            },
            {
                id: 6,
                name: "„Éò„É´„Ç∑„Éº„Éû„Éº„Éà „Ç∞„É™„Éº„É≥",
                category: "Ë≤©Â£≤Â∫ó",
                address: "ÂêçÂè§Â±ãÂ∏ÇÊò≠ÂíåÂå∫Âæ°Âô®ÊâÄÔºí‰∏ÅÁõÆÔºë‚àíÔºë",
                latitude: 35.1469,
                longitude: 136.9345,
                description: "„Ç∞„É´„ÉÜ„É≥„Éï„É™„ÉºÈ£üÂìÅË≤©Â£≤Â∫ó"
            }
        ];
        
        // „Ç´„ÉÜ„Ç¥„É™„ÉºË®≠ÂÆö
        function getCategoryConfig(category) {
            const configs = {
                '„Ç´„Éï„Çß': { color: '#8B4513', class: 'category-cafe' },
                'ÂíåÈ£ü': { color: '#FF6B6B', class: 'category-japanese' },
                'Ê¥ãÈ£ü': { color: '#4ECDC4', class: 'category-western' },
                '„Éë„É≥Â±ã': { color: '#FFB347', class: 'category-bakery' },
                '„Çπ„Ç§„Éº„ÉÑ': { color: '#FF69B4', class: 'category-sweets' },
                'Ë≤©Â£≤Â∫ó': { color: '#32CD32', class: 'category-shop' }
            };
            return configs[category] || { color: '#808080', class: 'category-other' };
        }
        
        // „É≠„Ç∞„Ç§„É≥Âá¶ÁêÜ
        async function login() {
            const email = document.getElementById('email').value.trim();
            const pin = document.getElementById('pin').value.trim();
            const errorDiv = document.getElementById('error');
            
            errorDiv.style.display = 'none';
            
            if (!email || !pin) {
                showError('„É°„Éº„É´„Ç¢„Éâ„É¨„Çπ„Å®PIN„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
                return;
            }
            
            try {
                console.log('üîê PINË™çË®ºÈñãÂßã:', email);
                
                const { data, error } = await supabase
                    .from('user_profiles')
                    .select('email, nickname, is_active')
                    .eq('email', email.toLowerCase())
                    .eq('pin', pin)
                    .eq('is_active', true)
                    .single();
                
                if (error) {
                    if (error.code === 'PGRST116') {
                        showError('„É°„Éº„É´„Ç¢„Éâ„É¨„Çπ„Åæ„Åü„ÅØPIN„ÅåÊ≠£„Åó„Åè„ÅÇ„Çä„Åæ„Åõ„Çì');
                    } else {
                        showError('„Ç∑„Çπ„ÉÜ„É†„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü');
                        console.error('Ë™çË®º„Ç®„É©„Éº:', error);
                    }
                } else if (data) {
                    console.log('‚úÖ PINË™çË®ºÊàêÂäü:', data);
                    currentUser = data.email;
                    showApp();
                } else {
                    showError('Ë™çË®º„Å´Â§±Êïó„Åó„Åæ„Åó„Åü');
                }
            } catch (e) {
                console.error('Ë™çË®º„Ç®„É©„Éº:', e);
                showError('„Ç∑„Çπ„ÉÜ„É†„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü');
            }
        }
        
        // „Ç®„É©„ÉºË°®Á§∫
        function showError(message) {
            const errorDiv = document.getElementById('error');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
        }
        
        // „Ç¢„Éó„É™ÁîªÈù¢Ë°®Á§∫
        function showApp() {
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('appScreen').style.display = 'block';
            
            initMap();
            displayStores();
        }
        
        // Âú∞Âõ≥ÂàùÊúüÂåñ
        function initMap() {
            if (map) return;
            
            map = L.map('map').setView([35.1815, 136.9066], 13);
            
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '¬© OpenStreetMap contributors'
            }).addTo(map);
            
            displayMapMarkers(stores);
        }
        
        // „Éû„ÉÉ„Éó„Éû„Éº„Ç´„ÉºË°®Á§∫
        function displayMapMarkers(storesData) {
            // Êó¢Â≠ò„Éû„Éº„Ç´„Éº„ÇíÂâäÈô§
            markers.forEach(marker => map.removeLayer(marker));
            markers = [];
            
            storesData.forEach(store => {
                if (store.latitude && store.longitude) {
                    const config = getCategoryConfig(store.category);
                    
                    const marker = L.marker([store.latitude, store.longitude], {
                        icon: L.divIcon({
                            className: 'custom-marker',
                            html: `<div class="custom-marker" style="background: ${config.color};">üìç</div>`,
                            iconSize: [30, 30],
                            iconAnchor: [15, 15]
                        })
                    }).addTo(map);
                    
                    marker.bindPopup(`
                        <div style="min-width: 200px;">
                            <strong>${store.name}</strong><br>
                            <span class="store-category ${config.class}">${store.category}</span><br>
                            <small>${store.address}</small><br>
                            ${store.description ? `<p style="margin-top: 8px; color: #666; font-size: 13px;">${store.description}</p>` : ''}
                        </div>
                    `);
                    
                    marker.on('click', () => selectStore(store.id));
                    markers.push(marker);
                }
            });
        }
        
        // Â∫óËàó„É™„Çπ„ÉàË°®Á§∫
        function displayStores() {
            const filteredStores = getFilteredStores();
            displayStoreList(filteredStores);
            displayMapMarkers(filteredStores);
            updateStoreCount(filteredStores.length);
            updateClearButton();
        }
        
        // „Éï„Ç£„É´„Çø„ÉºÈÅ©Áî®
        function getFilteredStores() {
            return stores.filter(store => {
                const matchesCategory = !selectedCategory || store.category === selectedCategory;
                const matchesSearch = !searchText || 
                    store.name.toLowerCase().includes(searchText.toLowerCase()) ||
                    store.address.toLowerCase().includes(searchText.toLowerCase()) ||
                    store.description.toLowerCase().includes(searchText.toLowerCase());
                
                return matchesCategory && matchesSearch;
            });
        }
        
        // Â∫óËàó„É™„Çπ„ÉàË°®Á§∫
        function displayStoreList(storesData) {
            const storeList = document.getElementById('storeList');
            
            if (storesData.length === 0) {
                storeList.innerHTML = `
                    <div class="no-results">
                        <i class="fas fa-search" style="font-size: 2rem; color: #ddd; margin-bottom: 10px;"></i>
                        <p>Êù°‰ª∂„Å´Âêà„ÅÜÂ∫óËàó„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì</p>
                    </div>
                `;
                return;
            }
            
            storeList.innerHTML = storesData.map(store => {
                const config = getCategoryConfig(store.category);
                return `
                    <div class="store-card" onclick="focusStore(${store.id})" data-store-id="${store.id}">
                        <div class="store-name">${store.name}</div>
                        <div class="store-category ${config.class}">${store.category}</div>
                        <div class="store-address">${store.address}</div>
                        ${store.description ? `<div style="color: #666; font-size: 12px; margin-top: 5px;">${store.description}</div>` : ''}
                    </div>
                `;
            }).join('');
        }
        
        // Â∫óËàóÊï∞Êõ¥Êñ∞
        function updateStoreCount(count) {
            const storeCount = document.getElementById('storeCount');
            storeCount.textContent = `${count}‰ª∂„ÅÆÂ∫óËàó`;
        }
        
        // „ÇØ„É™„Ç¢„Éú„Çø„É≥Ë°®Á§∫Âà∂Âæ°
        function updateClearButton() {
            const clearBtn = document.getElementById('clearBtn');
            const hasFilters = selectedCategory || searchText;
            clearBtn.style.display = hasFilters ? 'inline' : 'none';
        }
        
        // „Ç´„ÉÜ„Ç¥„É™„ÉºÈÅ∏Êäû
        function selectCategory(element) {
            // „Åô„Åπ„Å¶„ÅÆ„ÉÅ„ÉÉ„Éó„Åã„Çâ active „ÇØ„É©„Çπ„ÇíÂâäÈô§
            document.querySelectorAll('.category-chip').forEach(chip => {
                chip.classList.remove('active');
            });
            
            // ÈÅ∏Êäû„Åï„Çå„Åü„ÉÅ„ÉÉ„Éó„Å´ active „ÇØ„É©„Çπ„ÇíËøΩÂä†
            element.classList.add('active');
            
            selectedCategory = element.dataset.category;
            displayStores();
        }
        
        // Ê§úÁ¥¢„Éï„Ç£„É´„Çø„Éº
        function filterStores() {
            searchText = document.getElementById('searchInput').value.trim();
            displayStores();
        }
        
        // „Éï„Ç£„É´„Çø„Éº„ÇØ„É™„Ç¢
        function clearFilters() {
            selectedCategory = '';
            searchText = '';
            
            document.getElementById('searchInput').value = '';
            document.querySelectorAll('.category-chip').forEach(chip => {
                chip.classList.remove('active');
            });
            document.querySelector('.category-chip[data-category=""]').classList.add('active');
            
            displayStores();
        }
        
        // Â∫óËàóÈÅ∏Êäû
        function selectStore(storeId) {
            document.querySelectorAll('.store-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            const selectedCard = document.querySelector(`[data-store-id="${storeId}"]`);
            if (selectedCard) {
                selectedCard.classList.add('selected');
            }
        }
        
        // Â∫óËàó„Å´„Éï„Ç©„Éº„Ç´„Çπ
        function focusStore(storeId) {
            const store = stores.find(s => s.id === storeId);
            if (store && store.latitude && store.longitude) {
                map.setView([store.latitude, store.longitude], 16);
                selectStore(storeId);
            }
        }
        
        // „É≠„Ç∞„Ç¢„Ç¶„Éà
        function logout() {
            currentUser = null;
            document.getElementById('loginScreen').style.display = 'flex';
            document.getElementById('appScreen').style.display = 'none';
            
            // „Éï„Ç©„Éº„É†„É™„Çª„ÉÉ„Éà
            document.getElementById('email').value = 'bettger1000@gmail.com';
            document.getElementById('pin').value = '1234';
            document.getElementById('error').style.display = 'none';
            
            // „Éï„Ç£„É´„Çø„Éº„É™„Çª„ÉÉ„Éà
            clearFilters();
        }
        
        // Enter„Ç≠„Éº„Åß„É≠„Ç∞„Ç§„É≥
        document.addEventListener('keypress', function(e) {
            if (e.key === 'Enter' && document.getElementById('loginScreen').style.display !== 'none') {
                login();
            }
        });
        
        // ÂàùÊúüÂåñ
        console.log('üç∞ „Ç∞„É´„ÉÜ„É≥„Éï„É™„Éº„Éû„ÉÉ„ÉóÊã°ÂºµÁâàv1 ÂàùÊúüÂåñÂÆå‰∫Ü');
    </script>
</body>
</html>